PARTE 1.2 â€“ Arquitectura Global
ğŸ§© 1.2.1 â€“ Arquitectura FÃ­sica y LÃ³gica del Sistema
ğŸŒ Componentes Globales
Componente	TecnologÃ­a	FunciÃ³n Principal
App MÃ³vil	Flutter	Captura datos, tracking, formularios, alertas
Web Admin	React (Vite)	GestiÃ³n, builder, panel de control
API Backend	NestJS + Fastify	LÃ³gica de negocio, autenticaciÃ³n, control
BD Empresarial	SQL Server	Persistencia relacional, procedimientos
Almacenamiento Archivos	Azure Blob / S3 / MinIO	Adjuntos (fotos, firmas, audio)
Push Notifications	FCM	Notificaciones a dispositivos mÃ³viles
WebSocket Server	NestJS Gateway	Chat, tracking en vivo, alertas
Background Workers	NestJS + cron/queues	CÃ¡lculos, alertas programadas
Logs y AuditorÃ­a	Winston + SQL	Seguridad, rastreabilidad
ğŸ§  Arquitectura LÃ³gica
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flutter Appâ”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ NestJS API  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  SQL Server â”‚
â”‚ (Offline)  â”‚          â”‚  Fastify    â”‚          â”‚ Relacional â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚                       â”‚                          â”‚
      â–¼                       â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SQLite     â”‚         â”‚ WebSocket  â”‚           â”‚ Blob Storage â”‚
â”‚ + Sync     â”‚         â”‚ Gateway    â”‚           â”‚ (Adjuntos)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

           â–²
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ React Adminâ”‚
    â”‚ TanStack   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”„ 1.2.2 â€“ ComunicaciÃ³n entre Capas
Origen	Destino	Protocolo	PropÃ³sito
Flutter â†’ API	HTTPS (REST)	Login, tareas, formularios, sync	
Flutter â†’ API	WebSocket	Tracking en vivo, chat	
React â†’ API	HTTPS (REST)	CRUD, builder, panel, reportes	
API â†’ SQL Server	TDS (Driver mssql)	Queries, SPs, auditorÃ­a	
API â†’ Blob Storage	HTTPS	Upload de adjuntos	
API â†” WS Gateway	WS/Socket.IO	Emitir/recibir mensajes/chat	
API â†’ Flutter FCM	HTTPS + Token	Push notifications	
ğŸ” 1.2.3 â€“ Seguridad y Control

JWT + Refresh tokens

Interceptors para validar identidad en todos los endpoints

AuditorÃ­a global (tabla de eventos: mÃ³dulo, entidad, acciÃ³n, IP, antes/despuÃ©s)

Control de dispositivos registrados (Flutter)

RBAC multitenant por rol y empresa

Procedimientos SQL validados con TRY/CATCH + TRANSACTION

ğŸ—ºï¸ 1.2.4 â€“ Diagrama General
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                 Web Admin (React)              â”‚
                â”‚  - GestiÃ³n de usuarios                         â”‚
                â”‚  - AsignaciÃ³n de tareas                        â”‚
                â”‚  - Builder de formularios                     â”‚
                â”‚  - Mapa en vivo / Reportes                    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   API REST â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ NestJS     â”‚              â”‚
                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
                               â”‚                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
         â–¼                     â–¼            â–¼         â”‚
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
 â”‚ SQL Server â”‚         â”‚ WebSockets â”‚  â”‚ Blob Store â”‚â”‚
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ Tracking   â”‚  â”‚ Fotos/Firmaâ”‚â”‚
      â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
      â–¼                                      â–²        â”‚
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚        â”‚
 â”‚ Procedures â”‚                              â”‚        â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚        â”‚
      â–²                                      â”‚        â”‚
      â”‚                                      â”‚        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                     â–¼             â–¼                  â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
               â”‚Flutter App â”‚  â”‚FCM Push    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ§° 1.2.5 â€“ Recomendaciones de Infraestructura
Elemento	RecomendaciÃ³n
API	Contenedor Docker + PM2
SQL Server	Azure SQL Managed o VPS Linux/Windows
Blob Storage	Azure Blob o MinIO local
Notificaciones	Firebase Cloud Messaging
Logs	Winston rotado + backup en tabla
CI/CD	GitHub Actions + Vercel (web) + Deploy remoto backend