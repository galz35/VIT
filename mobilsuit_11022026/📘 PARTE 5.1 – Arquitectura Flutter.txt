ğŸ“˜ PARTE 5.1 â€“ Arquitectura Flutter: Estructura Modular y PatrÃ³n de CÃ³digo

Esta secciÃ³n define cÃ³mo debe estructurarse la app Flutter para mantener orden, escalabilidad y modularidad.

ğŸ§± 5.1.1 â€“ Estructura de Carpetas
/lib
 â”œâ”€â”€ main.dart
 â”œâ”€â”€ core/               # ConfiguraciÃ³n general y utilidades
 â”‚    â”œâ”€â”€ theme/
 â”‚    â”œâ”€â”€ services/
 â”‚    â”œâ”€â”€ network/
 â”‚    â”œâ”€â”€ models/
 â”‚    â”œâ”€â”€ constants.dart
 â”œâ”€â”€ features/           # Cada mÃ³dulo funcional aislado
 â”‚    â”œâ”€â”€ auth/
 â”‚    â”œâ”€â”€ tareas/
 â”‚    â”œâ”€â”€ formularios/
 â”‚    â”œâ”€â”€ tracking/
 â”‚    â”œâ”€â”€ sincronizacion/
 â”‚    â”œâ”€â”€ alertas/
 â”œâ”€â”€ shared/             # Widgets reutilizables
 â”‚    â”œâ”€â”€ components/
 â”‚    â”œâ”€â”€ dialogs/
 â”‚    â”œâ”€â”€ icons/
 â””â”€â”€ routes/             # DefiniciÃ³n de rutas con GoRouter

ğŸ§© 5.1.2 â€“ Estado y LÃ³gica
Elemento	LibrerÃ­a
Estado global y persistente	provider + ChangeNotifier
Llamadas HTTP	dio con interceptores
Cache + reintento	flutter_query o lÃ³gica manual
Almacenamiento local seguro	flutter_secure_storage
Base local offline	sqflite (formularios, tracking, syncQueue)
Background services	flutter_background_service + isolate compute()
ğŸ” 5.1.3 â€“ AutenticaciÃ³n Segura

Tokens JWT guardados cifrados

Interceptor que agrega Authorization: Bearer ...

Auto refresh en background si hay 401

ProtecciÃ³n de rutas con AuthGuard

ğŸ›°ï¸ 5.1.4 â€“ Servicio de Tracking GPS

Clase TrackingService:

class TrackingService {
  Future<void> iniciar() {
    // inicia background task
  }

  Future<void> registrarPunto() async {
    final pos = await Geolocator.getCurrentPosition();
    final punto = PuntoGPS(...);
    await DB.insertar('tracking', punto.toMap());
  }
}

ğŸ“ 5.1.5 â€“ Motor de Formulario DinÃ¡mico

Clase FormularioBuilderPage:

Recibe JSON desde backend (formulario_def)

Convierte a widgets (TextFormField, Dropdown, ImagePicker)

Guarda respuestas en respuestas_formulario_local

Permite firma digital (SignatureController)

Adjuntos se suben vÃ­a multipart/form-data

âš™ï¸ 5.1.6 â€“ SincronizaciÃ³n (Offline/Online)

Servicio SyncService:

Future<void> sincronizarTodo() async {
  await enviarFormulariosPendientes();
  await subirTracking();
  await subirArchivos();
}


Cola de errores con reintentos

SincronizaciÃ³n manual o programada

Interfaz con progreso visual por mÃ³dulo

ğŸ”” 5.1.7 â€“ Notificaciones y Eventos

Notificaciones push (FCM) â†’ firebase_messaging

AlertDialog para pÃ¡nico

NavegaciÃ³n reactiva con GoRouter.refreshListenable

ğŸ“² 5.1.8 â€“ Pantallas Clave
Ruta	Widget	DescripciÃ³n
/login	LoginPage	AutenticaciÃ³n
/home	HomePage	Dashboard de tareas
/tarea/:id	TareaDetallePage	Check-in, formulario
/formulario/:id	FormularioPage	Motor dinÃ¡mico
/alertas	AlertasPage	Ver alertas recientes
/sincronizar	SyncPage	Reintento manual

Â¿Te paso ahora la Parte 5.2 â€“ Estructura React: componentes, TanStack Query, hooks personalizados, diseÃ±o responsive?